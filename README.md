# Glyphs of Dialogue

A mash up of [GlyphNet](https://github.com/noahtren/GlyphNet) by [Noah Trenaman](https://noahtren.com/) and [Dimensions of Dialogue](https://www.joelsimon.net/dimensions-of-dialogue.html) by [Joel Simon](https://www.joelsimon.net/).

## Introduction

In this repository, two neural networks - a generator and a discriminator - must collaborate in order to construct their own visual language.

The generator is the same as one used in any conditional GAN (generative adversarial network) - it takes in a latent vector and a "label" and must use both to generate the image. Here, the "label" is a message - represented as a one-hot vector. This message must be sent to the discriminator through a noisy channel.

The discriminator's job is to correctly predict which message is being sent through the noisy channel, i.e. it must correctly classify the message represented by the image.

As well as training the models to communicate through the noisy channel we also send just noise into the discriminator - which it must correctly classify as noise and not a valid message.

## Results

Below we can see messages 1 to 121 generated by the discriminator in a noisy channel that adds Gaussian noise with standard deviations of 0.1, 0.5 and 1.0, respectively. These results are similar to that of the original [Dimensions of Dialogue blog post](https://www.joelsimon.net/dimensions-of-dialogue.html).

<p align="center">
 Gaussian noise with an initial standard deviation of 0.1
 <img src="./assets/0.1-0-0.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 0.5
 <img src="./assets/0.5-0-0.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 1.0
 <img src="./assets/1.0-0-0.png">
</p>

We can see that as the noise in the channel increases the visual representations become more robust to noise, e.g. the size of the "islands" of color increases.

As well as adding noise, we can shift the images output by the generator. Here are the same results as above with shifting added to the noisy channel. Again, we can see the images becoming more robust as the noise increases.

<p align="center">
 Gaussian noise with an initial standard deviation of 0.1<br>
 Shifting with an initial shift percent of 0.1
 <img src="./assets/0.1-0.1-0.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 0.5<br>
 Shifting with an initial shift percent of 0.1
 <img src="./assets/0.5-0.1-0.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 1.0<br>
 Shifting with an initial shift percent of 0.1
 <img src="./assets/1.0-0.1-0.png">
</p>

Finally, we can add rotations to noisy channel. These are added alongside the noise and the shifts mentioned previously.

<p align="center">
 Gaussian noise with an initial standard deviation of 0.1<br>
 Shifting with an initial shift percent of 0.1<br>
 Rotation with an initial angle of 10
 <img src="./assets/0.1-0.1-10.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 0.5<br>
 Shifting with an initial shift percent of 0.1<br>
 Rotation with an initial angle of 10
 <img src="./assets/0.5-0.1-10.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 1.0<br>
 Shifting with an initial shift percent of 0.1<br>
 Rotation with an initial angle of 10
 <img src="./assets/1.0-0.1-10.png">
</p>

Here are the above three experiments with `image_channels` set to 1, i.e. generated images are black and white.

<p align="center">
 Gaussian noise with an initial standard deviation of 0.1<br>
 Shifting with an initial shift percent of 0.1<br>
 Rotation with an initial angle of 10
 <img src="./assets/bw-0.1-0.1-10.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 0.5<br>
 Shifting with an initial shift percent of 0.1<br>
 Rotation with an initial angle of 10
 <img src="./assets/bw-0.5-0.1-10.png">
</p>

<p align="center">
 Gaussian noise with an initial standard deviation of 1.0<br>
 Shifting with an initial shift percent of 0.1<br>
 Rotation with an initial angle of 10
 <img src="./assets/bw-1.0-0.1-10.png">
</p>

## Notes

- All of the above models are created with the default hyperparameters, only the `noise_std`, `shift_pct` and `rot_angle` have been changed throughout the experiments.
- Generated images always have a height and width of 32 pixels.
- Models implemented in [PyTorch](https://pytorch.org) 1.5.1.
- [kornia](https://github.com/kornia/kornia) is required for rotations in the noisy channel.
- Shifting taken from the GlyphNet code [here](https://github.com/noahtren/GlyphNet/blob/master/glyphnet/noise.py#L85-L132). All images within a batch are shifted by the exact same amount.
- Another idea taken from GlpyhNet is to increase the amount of noise/shifting/rotation when the loss becomes too low.